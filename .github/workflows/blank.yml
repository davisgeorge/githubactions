name: CI cd
'on':
  push:
    branches:
      - main
      - release
      - test
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run a one-line script
        run: 'echo Hello, world!'
      - name: Run a multi-line script
        run: |
          echo Add other actions to build,
          echo test, and deploy your project.
          
      - name: Generate Git Tag
        id: generate_tag
        run: |

          echo "$GITHUB_ACTOR"
          git config user.name "GitHub Actions"
          git config user.email "github-actions@users.noreply.github.com"
          git tag -a V2 -m"test tag"
          git push origin --tags
        #   VERSION_PREFIX="v"

        #   VERSION_MAJOR_MINOR="1.0"

        #   VERSION_PATCH=$(git tag --list
        #   "${VERSION_PREFIX}${VERSION_MAJOR_MINOR}" --sort=-version:refname |
        #   head -n 1 | grep -oE '[0-9]+$')

        #   if [ -z "$VERSION_PATCH" ]; then
        #     VERSION_PATCH=0
        #   else
        #     VERSION_PATCH=$((VERSION_PATCH + 1))
        #   fi

        #   NEW_TAG="${VERSION_PREFIX}${VERSION_MAJOR_MINOR}.${VERSION_PATCH}"

        #   echo "Generated new tag: $NEW_TAG"

        #   echo "NEW_TAG=$NEW_TAG" >> $GITHUB_ENV
  dev-relase:
    name: Deploy-Dev
    if: '${{ github.ref == ''refs/heads/release'' }}'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          ref: release
      - name: this is dev branch
        run: |
          echo "this is dev-relase branch"
          git branch
  dev-test:
    name: Deploy-test
    if: '${{ github.ref == ''refs/heads/test'' }}'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          ref: release
      - name: this is dev branch
        run: |
          echo "this is dev-test branch"
          git branch
